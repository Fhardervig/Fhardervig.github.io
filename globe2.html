<!DOCTYPE HTML>
<html>

<head>
  <link rel="shortcut icon" href="icons/GS.ico">  
  <link rel="stylesheet" href="imgRez.css">
  <script src="http://www.webglearth.com/v2/api.js"></script>
  <script>
    var earth;
    var markerArray = [];
    var filt = []
    var data = [{
      name: "International Astronomy Youth Camp",
      category: "Camp",
      language: "English",
      target: ["High School", "University"],
      coord: [50.389960, 12.506516],
      logo: "https://www.iayc.org/images/iayc_logo_trans.png",
      link: "https://www.iayc.org/",
      summary: "The IAYC is an experience unlike any other; a place for unforgettable memories and lifelong friendships.Young and enthusiastic students come together from all corners of the world,aged between 16 and 24.The camp hosts around 65 participants for three weeks in a remote location,with access to some of the most spectacular skies you may have ever seen."
    }, {
      name: "Space Camp",
      category: "Camp",
      language: "English",
      target: ["High School"],
      coord: [34.710890, -86.652778],
      logo: "https://www.spacecamp.com/img/sc_logo_lrg.png",
      link: "https://www.spacecamp.com/",
      summary: "A one week camp in the US city that was the center of the American space race operations. Increase your knowledge about space and STEM topics through fun hands-on activities that will help you develop your leadership and teamwork skills. You will experience what astronauts experience during their training such as underwater tasks to simulate working on zero gravity and will command missions to the ISS, moon, or Mars."
    }, {
      name: "Griffith Observatory",
      category: "Observatory",
      language: "English",
      target: ["Anyone"],
      coord: [34.118248, -118.300362],
      logo: "https://ps.uci.edu/sites/default/files/multimedia.photos/v.jpg",
      link: "http://www.griffithobservatory.org/",
      summary: "Southern Californiaâ€™s gateway to the cosmos! Visitors can look through telescopes, explore exhibits, see live shows in the Samuel Oschin Planetarium, and enjoy spectacular views of Los Angeles and the Hollywood Sign."
    }, {
      name: "Space Vision",
      category: "Conference",
      language: "English",
      target: ["University"],
      coord: [33.417994, -111.928428],
      logo: "https://d3lut3gzcpx87s.cloudfront.net/image_encoded/aHR0cHM6Ly9zaWxrc3RhcnQuczMuYW1hem9uYXdzLmNvbS81OTJkZDJhODg5M2FhYTVlZjM5NTUzYTMucG5n/250x250",
      link: "https://spacevision.seds.org/2019",
      summary: "Join hundreds of passionate young professionals for the annual national conference of Students for the Exploration and Development of Space (SEDS). The conference is organized and run entirely by students, and will run through November 7th through November 10th, 2019. SpaceVision 2019 will be held at Arizona State University's main campus in Tempe, AZ."
    }, {
      name: "The International Astronautical Congress",
      category: "Conference",
      language: "English",
      target: ["Anyone"],
      coord: [38.904856, -77.022971],
      logo: "https://www.iac2019.org/images/librariesprovider2/site-layout/logos/logo.png?sfvrsn=6dafc13a_4",
      link: "http://www.iafastro.org/events/iac/",
      summary: "The IAC is the one time of the year when all space actors come together. Global, multidisciplinary and covering all space sectors and topics, it offers everyone the latest space information, developments but above all contacts and potential partnerships.

Each year, the IAC changes country, theme and local organiser, enabling all to learn more about, and be a part of the world space scene."
    }];

    function initialize() {
      var options = {
        sky: true,
        tilting: false,
        zooming: true,
        zoom: 3
      };
      earth = WE.map('earth', tilting = false);
      WE.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(earth);
      setMarkers(data);
      console.log('Init complete')
    }

    function setMarkers(opps) {
      var i;
      for (i = 0; i < opps.length; i++) {
        var marker = WE.marker(opps[i]['coord'], 'icons/' + opps[i]['category'] + '.png', 50, 50).addTo(earth);
        marker.bindPopup("<div class= 'flexcontainer'><img class='resize' src=" + opps[i]['logo'] + " align='top'><ul><li><a align='left' href=" + opps[i]['link'] + ">" + opps[i]['name'] + "</a></li><li>Age: "+opps[i]['target']+"</li><li>Language: "+opps[i]['language']+"</li></ul></div><br><span style='font-size:12px;color:#999'>" + opps[i]['summary'] + "</span>", {
          maxWidth: 300,
          closeButton: true
        });
        markerArray.push(marker);
      }
    }

    function setZoom(zoom) {
      earth.setZoom(zoom);
    }

    function funcPanTo(coords) {
      earth.panTo(coords);
    }

    function unpin() {
      for (var i = 0; i < markerArray.length; i++) {
        markerArray[i].removeFrom(earth);
      };
    }

    function filterCombineOr(obj, filterArray) {
      var catFilt = []
      var lvlFilt = []
      for (let filter of filterArray) {
        if (filter[0] === "category") {
          catFilt.push(filter)
        } else if (filter[0] === "target") {
          lvlFilt.push(filter)
        }
      }
      if (catFilt.length == 0) {
        for (let lFilter of lvlFilt) {
            if (lFilter[2](obj) || obj.target.includes('Anyone')) {
              console.log("Show", obj["name"])
              return true;
            }
          }
      } else if (lvlFilt.length == 0) {
        for (let cFilter of catFilt) {
          if (cFilter[2](obj)) {
            console.log("Show", obj["name"])
            return true;
          }
        }
      } else {
        for (let lFilter of lvlFilt) {
          for (let cFilter of catFilt) {
              if ((lFilter[2](obj) && cFilter[2](obj)) || (cFilter[2](obj) && obj.target.includes('Anyone'))) {
              console.log("Show", obj["name"])
              return true;
            }
          }
        }
      }
      console.log("Hide", obj["name"])
      return false;
    }

    function filterFunc(check, group, identifier) {
      // Get the checkbox
      var checkBox = document.getElementById(check);
      // If the checkbox is checked, display the output text
      if (checkBox.checked == true) {
        console.log("Checked", checkBox.id)
        //console.log(d => d.indexOf(group) === identifier)
        if (group === "category") {
          if (identifier === "Camp") {
            filt.push([group, identifier, d => d.category === 'Camp'])
          } else if (identifier === "Conference") {
            filt.push([group, identifier, d => d.category === 'Conference'])
          } else if (identifier === "Observatory") {
            filt.push([group, identifier, d => d.category === 'Observatory'])
          } else if (identifier === "Stargazing") {
            filt.push([group, identifier, d => d.category === 'Stargazing'])
          } else if (identifier === "Internship") {
            filt.push([group, identifier, d => d.category === 'Internship'])
          } else if (identifier === "Competition") {
            filt.push([group, identifier, d => d.category === 'Competition'])
          }
        } else if (group === "target") {
          if (identifier === "High School") {
            filt.push([group, identifier, d => d.target.includes('High School')])
          } else if (identifier === "University") {
            filt.push([group, identifier, d => d.target.includes('University')])
          }
        }
      } else {
        console.log("Unchecked", checkBox.id)
        for (var i = 0; i < filt.length; i++) {
          if (filt[i][1] === identifier) filt.splice(i, 1);
        }
      }
      console.log(filt)
      var filtopps = data.filter(d => filterCombineOr(d, filt));
      unpin();
      if (filt.length == 0) {
        setMarkers(data);
      } else {
        setMarkers(filtopps);
      }
    }
  </script>
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }

    #earth {
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: #000;
      position: absolute;
    }

    #coords {
      position: absolute;
      bottom: 10px;
      right: 10px;
      z-index: 100000;
    }

    #buttons {
      position: absolute;
      top: 10px;
      left: 10px;
    }

    #layercontrol {
      position: absolute;
      top: 10px;
      right: 10px;
    }
  </style>
  <title>Guiding Star: Your guide to the stars</title>
</head>

<body onload="initialize()">
  <div id="checkboxes">
    | Display camps? <input type="checkbox" id="campCheck" onclick="filterFunc('campCheck', 'category', 'Camp')"> | Display conferences? <input type="checkbox" id="conferenceCheck" onclick="filterFunc('conferenceCheck', 'category', 'Conference')"> 
    | Display competitions? <input type="checkbox" id="competitionCheck" onclick="filterFunc('competitionCheck', 'category', 'Competition')"> | Display observatories? <input type="checkbox" id="obsCheck" onclick="filterFunc('obsCheck', 'category', 'Observatory')">
    | Display internships? <input type="checkbox" id="intCheck" onclick="filterFunc('intCheck', 'category', 'Internship')"> | Display stargazing? <input type="checkbox" id="stargazeCheck" onclick="filterFunc('stargazeCheck', 'category', 'Stargazing')">
    <br> | High School? <input type="checkbox" id="highCheck" onclick="filterFunc('highCheck', 'target', 'High School')"> | University? <input type="checkbox" id="uniCheck" onclick="filterFunc('uniCheck', 'target', 'University')">
  </div>
  <div id="earth"></div>
  <div id="coords"></div>
</div>
</body>

</html><!DOCTYPE HTML>
<html>
